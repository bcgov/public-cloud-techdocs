# Be mindful

Last updated: **{{ git_revision_date_localized }}**

The following are important things to be aware of when working within the AWS Landing Zone Accelerator (LZA). Understanding these considerations will help you design better applications and avoid common pitfalls.

## Network connectivity limitations

### Cross-account network isolation

One of the most important constraints in LZA is that **none of the VPCs can communicate with each other**. Dev, Test, Prod, and Tools accounts are completely network-isolated from each other. This has significant implications for application architecture and CI/CD pipeline design:

!!! warning "Complete VPC isolation"

    **No VPC can communicate privately with any other VPC** in your project set. This means:
    
    - VPCs are completely isolated across accounts
    - Cross-account communication requires AWS APIs or public endpoints

    If your deployment requires private network access to resources in other accounts (such as private databases or internal services), you must run your CI/CD pipelines directly within each target account.

### Government network connectivity

There is **no direct (private) connectivity** to the B.C. government network. Applications requiring access to government network data must use public endpoints with proper authentication and encryption.

!!! note "Direct Connect coming soon"

    Direct Connect is planned to provide private connectivity to the B.C. government network in the future, but there is no confirmed timeline.

### HTTPS requirement

Only **HTTPS applications** are compatible with public endpoints through [Amazon API Gateway](https://docs.aws.amazon.com/apigateway/) or [Application Load Balancer](https://docs.aws.amazon.com/elasticloadbalancing/latest/application/). Plan your application architecture accordingly.

## Regional and infrastructure constraints

### Canada Central region only

LZA **only supports Canada Central (`ca-central-1`) region**. All your AWS resources must be deployed in this region. When using Infrastructure as Code tools, always specify:

```terraform
provider "aws" {
  region = "ca-central-1"  # Required for LZA
}
```

### Platform-managed networking

**VPCs and subnets are managed by the platform** and cannot be created or modified by users. You cannot:

- Create new VPCs or subnets
- Modify existing network configurations
- Create custom routing tables
- Modify network ACLs

**Security groups can be created by users** - you can create new security groups within the existing VPC structure, but platform-created security groups with Accelerator tags cannot be modified.

!!! tip "Working with managed networking"

    Focus your networking efforts on security group configuration and understand the existing VPC structure. Use `aws ec2 describe-vpcs` and `aws ec2 describe-subnets` to discover available networks in your accounts.

## Permission and access management

### Permission synchronization delays

After user permissions are granted or modified through Entra ID security groups, **it can take up to 40 minutes** for changes to synchronize across all AWS accounts in your project set.

!!! warning "Plan for access delays"

    When onboarding new team members or changing permissions, factor in the 40-minute synchronization window. Don't expect immediate access after group membership changes.

### IAM User restrictions

**IAM Users and their access keys can only be generated by the [IAM User management service](../design-build-deploy/iam-user-service.md)**, which is created and managed by the Public cloud team. You cannot:

- Create IAM users directly
- Generate access keys manually
- Manage user credentials independently

Use IAM roles and temporary credentials through the [AWS SSO Portal](https://bcgov.awsapps.com/start/#/?tab=accounts) instead. For detailed information about creating and managing IAM users, see the [IAM User management service documentation](../design-build-deploy/iam-user-service.md).

### Role-based access structure

LZA uses five predefined roles with specific access patterns:

- **Admins**: Full access to all accounts (including production)
- **Developers**: Admin access to dev, test, and tools (not production)
- **Viewers**: Read-only access to all accounts
- **Billing viewers**: Access to cost and billing information
- **Security auditors**: Access to security configurations and audit logs

!!! info "Production access requires Admin role"

    Unlike other environments where Developers have admin access, **production access requires the Admin role**. Plan your team structure and deployment workflows accordingly.

## AI and machine learning limitations

### Model marketplace restrictions

The **AWS marketplace for AI models is not available** in the BC Government environment. This significantly limits foundation model options:

!!! warning "Limited AI model availability"

    **Available models only**:
    
    - Amazon Titan models (Text, Embeddings, Image, Multimodal)
    - Mistral models (Mistral 7B, Mixtral)

    Popular models like Anthropic Claude, Meta Llama, Cohere, and others **cannot be used**.

If your application requires specific AI capabilities not available in Titan or Mistral models, consider:

- Training custom models with [Amazon SageMaker](https://docs.aws.amazon.com/sagemaker/)
- Using other AWS AI services like [Amazon Comprehend](https://docs.aws.amazon.com/comprehend/) or [Amazon Textract](https://docs.aws.amazon.com/textract/)
- Discussing alternatives with the Public Cloud team

## Cost management considerations

### Budget monitoring and alerts

Configure budget alerts early through the [Product Registry](https://registry.developer.gov.bc.ca/login) to avoid unexpected costs. AWS charges can accumulate quickly, especially with:

- Data transfer charges
- Storage costs in S3
- Compute time in ECS, Lambda, or EC2
- AI service usage (particularly expensive for large-scale processing)

### Resource tagging for organization

Apply **consistent tags to all resources** for proper organization and management:

```terraform
tags = {
  Project     = "your-project-name"
  Environment = "dev" # or test, prod, tools
  Owner       = "team-name"
  Purpose     = "web-app" # or database, ml-model, etc.
}
```

!!! tip "Tag everything from day one"

    Establish your tagging strategy before deploying resources for better organization and resource management.

## Security and compliance considerations

### Data residency requirements

All data must remain in **Canada Central region** to meet BC Government data residency requirements. Be careful with:

- Cross-region replication features (disabled by default)
- Third-party service integrations that might move data
- Backup and disaster recovery strategies

### Encryption requirements

- **Data at rest**: Use [AWS KMS](https://docs.aws.amazon.com/kms/) for encryption keys
- **Data in transit**: Ensure TLS encryption for all communications
- **Application secrets**: Store in [AWS Secrets Manager](https://docs.aws.amazon.com/secretsmanager/) or [Systems Manager Parameter Store](https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-parameter-store.html)

### Audit and logging

All AWS API calls are automatically logged through [AWS CloudTrail](https://docs.aws.amazon.com/cloudtrail/). Ensure your applications:

- Use structured logging
- Don't log sensitive information
- Implement proper log retention policies
- Monitor for security events

## Development workflow considerations

### Infrastructure as Code is mandatory

Use Infrastructure as Code tools for all deployments:

- **[Terraform](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)** (most common)
- **[AWS CloudFormation](https://docs.aws.amazon.com/cloudformation/)**
- **[AWS CDK](https://docs.aws.amazon.com/cdk/)**

Manual changes through the AWS console are discouraged and can lead to configuration drift.

### State management for teams

When using Terraform in teams, **always use remote state storage**:

```terraform
terraform {
  backend "s3" {
    bucket         = "your-terraform-state-bucket"
    key            = "infrastructure/terraform.tfstate"
    region         = "ca-central-1"
    encrypt        = true
    dynamodb_table = "terraform-state-lock"
  }
}
```

!!! failure "Local state files are dangerous"

    Never use local Terraform state files in team environments. They lead to conflicts, lost state, and potential resource corruption.

### Environment promotion strategy

Design your deployment pipeline to account for complete Virtual Private Cloud (VPC) isolation:

- **API-based deployments**: Can be centralized in Tools account (using AWS APIs only)
- **VPC-based deployments**: Must run within each target account individually
- **Cross-account data sharing**: Must use public endpoints or AWS services (S3, SQS, etc.)
- **Database access**: Cannot connect directly between accounts - each account needs its own database or use public endpoints

## Common pitfalls and how to avoid them

### Assuming cross-account connectivity

**Don't assume** any account can directly access resources in other accounts via private networking. **All VPCs are completely isolated** - design your application architecture and CI/CD pipelines accordingly.

### Forgetting permission delays

**Don't expect immediate access** after user permission changes. Plan deployment schedules around the 40-minute synchronization window.

### Using hardcoded regions

**Always parameterize regions** in your Infrastructure as Code, even though LZA only supports Canada Central. This makes your code more portable and explicit.

### Ignoring cost monitoring

**Set up cost alerts immediately** when starting development. AWS costs can surprise teams who aren't monitoring actively.

### Creating manual resources

**Avoid manual resource creation** through the AWS console. Use Infrastructure as Code for everything to maintain consistency and version control.

## Getting help

When you encounter issues or need clarification:

- **Platform limitations**: Contact the [Public Cloud Service Desk](https://citz-do.atlassian.net/servicedesk/customer/portal/3)
- **AWS technical questions**: Use [AWS Enterprise Support](../support/enterprise-support.md) in your production account
- **Best practices**: Review our [IaC and CI/CD guide](iac-and-ci-cd.md) and [AWS services guidance](aws-services.md)
- **General support**: See our [support page](../../../welcome/support.md) for all available options

Understanding these constraints and working within them will help you build robust, compliant applications on the AWS Landing Zone Accelerator platform.
